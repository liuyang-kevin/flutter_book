<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <button id="startRecord">startRecord</button>
    <button id="stopRecord">stopRecord</button>

    <div>
        <a href="https://pulakk.github.io/Live-Audio-MFCC/tutorial.html">Live Audio MFCC (Web Audio API)</a>
        <br>
        <a href="https://github.com/pulakk/Live-Audio-MFCC/blob/master/assets/js/sketch.js">js</a>
    </div>
    <script>
        console.log(navigator.mediaDevices.getSupportedConstraints());
        var audio;
        var mediaConstraints = {
            audio: {
                echoCancellation: { exact: true },
                googEchoCancellation: { exact: true },
                googAutoGainControl: { exact: true },
                googNoiseSuppression: { exact: true },
            }
        }

        function stopAudio() {
            if (audio) {
                audio.srcObject.getTracks().forEach(function (track) {
                    if (track.readyState == 'live' && track.kind === 'audio') {
                        track.stop();
                    }
                });
                audio = null;
            }
        }

        document.getElementById("stopRecord").onclick = () => {
            stopAudio();
        };

        document.getElementById("startRecord").onclick = () => {
            stopAudio();
            navigator.mediaDevices.getUserMedia(mediaConstraints)
                .then(stream => {
                    console.log(stream);
                    audio = new Audio();
                    audio.srcObject = stream;
                    audio.play();
                })
                .catch(e => console.log(e));
        };


    </script>
</body>

</html>